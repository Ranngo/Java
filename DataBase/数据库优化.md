# 数据库优化

## 1. 分表

垂直分表：将一个表按照字段拆分成多个表，每个表存储其中一部分字段。通过分离 **热门字段**和**冷门字段**，**大字段**和**小字段**，**经常组合查询的字段**来提高性能。

优点：

* 数据库以行为单位将数据加载到内存，单行数据量过大，需要更长的读取时间。行内字段越少，加载速度越快

* 数据库以页为存储单位，数据的查找和定位都是以页为单位，每页可容纳的数据行数越多，内存可加载更多数据，命中率越高，数据库整体性能越好。字段多会占用大量空间，导致单页内数据行数少，IO效率低。



水平分表：在同一个数据库内，把同一个表的数据按一定规则拆到多个表中。

优点：

* 减少IO冲突和锁表的概率
* 减少因单表数据量过大导致的性能问题



## 2. 分库

垂直分库：按照业务将表进行分类，分布到不同的数据库上面，每个库可以放在不同的服务器上，它的核心理念是专库专用。

优点：

* 数据还是始终限制在一台服务器，库内垂直分表只解决了单一表数据量过大的问题，但没有将表分布到不同的服务器上，因此每个表还是竞争同一个物理机的CPU、内存、网络IO、磁盘。垂直分库通过将表按业务分类，然后分布在不同数据库，并且可以将这些数据库部署在不同服务器上，从而达到多个服务器共同分摊压力的效果
* 解决业务层面的耦合，业务清晰



水平分库: 按照一定规则将同一张表的数据拆分到不同的数据库。

优点：

* 对数据行的拆分，不影响数据库结构。

* 降低单库数据量，提高高并发能力。
* IO冲突减少，提高系统稳定性，某个库出现问题时，其他库仍可使用。

参考博客：

(1) https://blog.csdn.net/weixin_44062339/article/details/100491744?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163080957516780255270763%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=163080957516780255270763&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-100491744.first_rank_v2_pc_rank_v29&utm_term=%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8&spm=1018.2226.3001.4187

(2) https://www.cnblogs.com/littlecharacter/p/9342129.html